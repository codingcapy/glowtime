import{S as P,s as k,o as v,q as E,e as w,u as U,g as l,n as A,h as _}from"./index-BsquF79R.js";var q=class extends P{#r;#s=void 0;#e;#t;constructor(e,r){super(),this.#r=e,this.setOptions(r),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#r.defaultMutationOptions(e),k(this.options,r)||this.#r.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),r?.mutationKey&&this.options.mutationKey&&v(r.mutationKey)!==v(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(e){this.#i(),this.#a(e)}getCurrentResult(){return this.#s}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#i(),this.#a()}mutate(e,r){return this.#t=r,this.#e?.removeObserver(this),this.#e=this.#r.getMutationCache().build(this.#r,this.options),this.#e.addObserver(this),this.#e.execute(e)}#i(){const e=this.#e?.state??E();this.#s={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){w.batch(()=>{if(this.#t&&this.hasListeners()){const r=this.#s.variables,t=this.#s.context;e?.type==="success"?(this.#t.onSuccess?.(e.data,r,t),this.#t.onSettled?.(e.data,null,r,t)):e?.type==="error"&&(this.#t.onError?.(e.error,r,t),this.#t.onSettled?.(void 0,e.error,r,t))}this.listeners.forEach(r=>{r(this.#s)})})}};function K(e,r){const t=U(),[s]=l.useState(()=>new q(t,e));l.useEffect(()=>{s.setOptions(e)},[s,e]);const i=l.useSyncExternalStore(l.useCallback(n=>s.subscribe(w.batchCalls(n)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),a=l.useCallback((n,h)=>{s.mutate(n,h).catch(A)},[s]);if(i.error&&_(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}var $=(e,r,t={})=>{let s=`${e}=${r}`;if(e.startsWith("__Secure-")&&!t.secure)throw new Error("__Secure- Cookie must have Secure attributes");if(e.startsWith("__Host-")){if(!t.secure)throw new Error("__Host- Cookie must have Secure attributes");if(t.path!=="/")throw new Error('__Host- Cookie must have Path attributes with "/"');if(t.domain)throw new Error("__Host- Cookie must not have Domain attributes")}if(t&&typeof t.maxAge=="number"&&t.maxAge>=0){if(t.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");s+=`; Max-Age=${t.maxAge|0}`}if(t.domain&&t.prefix!=="host"&&(s+=`; Domain=${t.domain}`),t.path&&(s+=`; Path=${t.path}`),t.expires){if(t.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");s+=`; Expires=${t.expires.toUTCString()}`}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.sameSite&&(s+=`; SameSite=${t.sameSite.charAt(0).toUpperCase()+t.sameSite.slice(1)}`),t.priority&&(s+=`; Priority=${t.priority.charAt(0).toUpperCase()+t.priority.slice(1)}`),t.partitioned){if(!t.secure)throw new Error("Partitioned Cookie must have Secure attributes");s+="; Partitioned"}return s},j=(e,r,t)=>(r=encodeURIComponent(r),$(e,r,t)),M=(e,r)=>(e=e.replace(/\/+$/,""),e=e+"/",r=r.replace(/^\/+/,""),e+r),y=(e,r)=>{for(const[t,s]of Object.entries(r)){const i=new RegExp("/:"+t+"(?:{[^/]+})?\\??");e=e.replace(i,s?`/${s}`:"")}return e},S=e=>{const r=new URLSearchParams;for(const[t,s]of Object.entries(e))if(s!==void 0)if(Array.isArray(s))for(const i of s)r.append(t,i);else r.set(t,s);return r},R=(e,r)=>{switch(r){case"ws":return e.replace(/^http/,"ws");case"http":return e.replace(/^ws/,"http")}},g=e=>/^https?:\/\/[^\/]+?\/index(?=\?|$)/.test(e)?e.replace(/\/index(?=\?|$)/,"/"):e.replace(/\/index(?=\?|$)/,"");function d(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function x(e,r){if(!d(e)&&!d(r))return r;const t={...e};for(const s in r){const i=r[s];d(t[s])&&d(i)?t[s]=x(t[s],i):t[s]=i}return t}var O=(e,r)=>new Proxy(()=>{},{get(s,i){if(!(typeof i!="string"||i==="then"))return O(e,[...r,i])},apply(s,i,a){return e({path:r,args:a})}}),T=class{url;method;queryParams=void 0;pathParams={};rBody;cType=void 0;constructor(e,r){this.url=e,this.method=r}fetch=async(e,r)=>{if(e){if(e.query&&(this.queryParams=S(e.query)),e.form){const h=new FormData;for(const[c,u]of Object.entries(e.form))if(Array.isArray(u))for(const o of u)h.append(c,o);else h.append(c,u);this.rBody=h}e.json&&(this.rBody=JSON.stringify(e.json),this.cType="application/json"),e.param&&(this.pathParams=e.param)}let t=this.method.toUpperCase();const s={...e?.header,...typeof r?.headers=="function"?await r.headers():r?.headers};if(e?.cookie){const h=[];for(const[c,u]of Object.entries(e.cookie))h.push(j(c,u,{path:"/"}));s.Cookie=h.join(",")}this.cType&&(s["Content-Type"]=this.cType);const i=new Headers(s??void 0);let a=this.url;a=g(a),a=y(a,this.pathParams),this.queryParams&&(a=a+"?"+this.queryParams.toString()),t=this.method.toUpperCase();const n=!(t==="GET"||t==="HEAD");return(r?.fetch||fetch)(a,{body:n?this.rBody:void 0,method:t,headers:i,...r?.init})}},H=(e,r)=>O(function t(s){const i=[...s.path],a=i.slice(-3).reverse();if(a[0]==="toString")return a[1]==="name"?a[2]||"":t.toString();if(a[0]==="valueOf")return a[1]==="name"?a[2]||"":t;let n="";if(/^\$/.test(a[0])){const o=i.pop();o&&(n=o.replace(/^\$/,""))}const h=i.join("/"),c=M(e,h);if(n==="url"){let o=c;return s.args[0]&&(s.args[0].param&&(o=y(c,s.args[0].param)),s.args[0].query&&(o=o+"?"+S(s.args[0].query).toString())),o=g(o),new URL(o)}if(n==="ws"){const o=R(s.args[0]&&s.args[0].param?y(c,s.args[0].param):c,"ws"),m=new URL(o),b=s.args[0]?.query;return b&&Object.entries(b).forEach(([f,p])=>{Array.isArray(p)?p.forEach(C=>m.searchParams.append(f,C)):m.searchParams.set(f,p)}),((...f)=>r?.webSocket!==void 0&&typeof r.webSocket=="function"?r.webSocket(...f):new WebSocket(...f))(m.toString())}const u=new T(c,n);if(n){r??={};const o=x(r,{...s.args[1]});return u.fetch(s.args[0],o)}return u},[]);const D="https://glowtime-production.up.railway.app",W=H(D);export{W as c,K as u};
