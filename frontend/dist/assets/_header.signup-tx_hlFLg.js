import{S as k,s as A,h as b,g as U,n as g,c as S,r as d,d as N,e as q,u as M,a as _,j as h,L as $}from"./index-fA85UbTc.js";var R=class extends k{#r;#s=void 0;#e;#t;constructor(e,r){super(),this.#r=e,this.setOptions(r),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#r.defaultMutationOptions(e),A(this.options,r)||this.#r.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),r?.mutationKey&&this.options.mutationKey&&b(r.mutationKey)!==b(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(e){this.#i(),this.#a(e)}getCurrentResult(){return this.#s}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#i(),this.#a()}mutate(e,r){return this.#t=r,this.#e?.removeObserver(this),this.#e=this.#r.getMutationCache().build(this.#r,this.options),this.#e.addObserver(this),this.#e.execute(e)}#i(){const e=this.#e?.state??U();this.#s={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){g.batch(()=>{if(this.#t&&this.hasListeners()){const r=this.#s.variables,t=this.#s.context;e?.type==="success"?(this.#t.onSuccess?.(e.data,r,t),this.#t.onSettled?.(e.data,null,r,t)):e?.type==="error"&&(this.#t.onError?.(e.error,r,t),this.#t.onSettled?.(void 0,e.error,r,t))}this.listeners.forEach(r=>{r(this.#s)})})}};function L(e,r){const t=S(),[s]=d.useState(()=>new R(t,e));d.useEffect(()=>{s.setOptions(e)},[s,e]);const i=d.useSyncExternalStore(d.useCallback(n=>s.subscribe(g.batchCalls(n)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),a=d.useCallback((n,u)=>{s.mutate(n,u).catch(N)},[s]);if(i.error&&q(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}var T=(e,r,t={})=>{let s=`${e}=${r}`;if(e.startsWith("__Secure-")&&!t.secure)throw new Error("__Secure- Cookie must have Secure attributes");if(e.startsWith("__Host-")){if(!t.secure)throw new Error("__Host- Cookie must have Secure attributes");if(t.path!=="/")throw new Error('__Host- Cookie must have Path attributes with "/"');if(t.domain)throw new Error("__Host- Cookie must not have Domain attributes")}if(t&&typeof t.maxAge=="number"&&t.maxAge>=0){if(t.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");s+=`; Max-Age=${t.maxAge|0}`}if(t.domain&&t.prefix!=="host"&&(s+=`; Domain=${t.domain}`),t.path&&(s+=`; Path=${t.path}`),t.expires){if(t.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");s+=`; Expires=${t.expires.toUTCString()}`}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.sameSite&&(s+=`; SameSite=${t.sameSite.charAt(0).toUpperCase()+t.sameSite.slice(1)}`),t.priority&&(s+=`; Priority=${t.priority.charAt(0).toUpperCase()+t.priority.slice(1)}`),t.partitioned){if(!t.secure)throw new Error("Partitioned Cookie must have Secure attributes");s+="; Partitioned"}return s},D=(e,r,t)=>(r=encodeURIComponent(r),T(e,r,t)),H=(e,r)=>(e=e.replace(/\/+$/,""),e=e+"/",r=r.replace(/^\/+/,""),e+r),v=(e,r)=>{for(const[t,s]of Object.entries(r)){const i=new RegExp("/:"+t+"(?:{[^/]+})?\\??");e=e.replace(i,s?`/${s}`:"")}return e},j=e=>{const r=new URLSearchParams;for(const[t,s]of Object.entries(e))if(s!==void 0)if(Array.isArray(s))for(const i of s)r.append(t,i);else r.set(t,s);return r},I=(e,r)=>{switch(r){case"ws":return e.replace(/^http/,"ws");case"http":return e.replace(/^ws/,"http")}},E=e=>/^https?:\/\/[^\/]+?\/index(?=\?|$)/.test(e)?e.replace(/\/index(?=\?|$)/,"/"):e.replace(/\/index(?=\?|$)/,"");function y(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function C(e,r){if(!y(e)&&!y(r))return r;const t={...e};for(const s in r){const i=r[s];y(t[s])&&y(i)?t[s]=C(t[s],i):t[s]=i}return t}var O=(e,r)=>new Proxy(()=>{},{get(s,i){if(!(typeof i!="string"||i==="then"))return O(e,[...r,i])},apply(s,i,a){return e({path:r,args:a})}}),K=class{url;method;queryParams=void 0;pathParams={};rBody;cType=void 0;constructor(e,r){this.url=e,this.method=r}fetch=async(e,r)=>{if(e){if(e.query&&(this.queryParams=j(e.query)),e.form){const u=new FormData;for(const[c,l]of Object.entries(e.form))if(Array.isArray(l))for(const o of l)u.append(c,o);else u.append(c,l);this.rBody=u}e.json&&(this.rBody=JSON.stringify(e.json),this.cType="application/json"),e.param&&(this.pathParams=e.param)}let t=this.method.toUpperCase();const s={...e?.header,...typeof r?.headers=="function"?await r.headers():r?.headers};if(e?.cookie){const u=[];for(const[c,l]of Object.entries(e.cookie))u.push(D(c,l,{path:"/"}));s.Cookie=u.join(",")}this.cType&&(s["Content-Type"]=this.cType);const i=new Headers(s??void 0);let a=this.url;a=E(a),a=v(a,this.pathParams),this.queryParams&&(a=a+"?"+this.queryParams.toString()),t=this.method.toUpperCase();const n=!(t==="GET"||t==="HEAD");return(r?.fetch||fetch)(a,{body:n?this.rBody:void 0,method:t,headers:i,...r?.init})}},W=(e,r)=>O(function t(s){const i=[...s.path],a=i.slice(-3).reverse();if(a[0]==="toString")return a[1]==="name"?a[2]||"":t.toString();if(a[0]==="valueOf")return a[1]==="name"?a[2]||"":t;let n="";if(/^\$/.test(a[0])){const o=i.pop();o&&(n=o.replace(/^\$/,""))}const u=i.join("/"),c=H(e,u);if(n==="url"){let o=c;return s.args[0]&&(s.args[0].param&&(o=v(c,s.args[0].param)),s.args[0].query&&(o=o+"?"+j(s.args[0].query).toString())),o=E(o),new URL(o)}if(n==="ws"){const o=I(s.args[0]&&s.args[0].param?v(c,s.args[0].param):c,"ws"),f=new URL(o),m=s.args[0]?.query;return m&&Object.entries(m).forEach(([p,x])=>{Array.isArray(x)?x.forEach(P=>f.searchParams.append(p,P)):f.searchParams.set(p,x)}),((...p)=>r?.webSocket!==void 0&&typeof r.webSocket=="function"?r.webSocket(...p):new WebSocket(...p))(f.toString())}const l=new K(c,n);if(n){r??={};const o=C(r,{...s.args[1]});return l.fetch(s.args[0],o)}return l},[]);const B="https://glowtime-production.up.railway.app",z=W(B);function F(e){return{...e,createdAt:new Date(e.createdAt)}}async function G(e){const r=await z.api.v0.users.$post({json:e});if(!r.ok){let s="There was an issue creating your account :( We'll look into it ASAP!";try{const i=await r.json();i&&typeof i=="object"&&"message"in i&&(s=String(i.message))}catch(i){console.error("Failed to parse error response:",i)}throw new Error(s)}const t=await r.json();if(!t.user)throw new Error("Invalid response from server");return F(t.user)}const Q=e=>{const r=S();return L({mutationFn:G,onSettled:t=>{if(!t)return console.log(t,"create args, returning");r.invalidateQueries({queryKey:["users"]})},onError:t=>{}})};function V(){const e=M(),[r,t]=d.useState(""),{mutate:s}=Q(),[i,a]=d.useState(""),{loginService:n,authLoading:u,user:c}=_(o=>o);d.useEffect(()=>{c&&e({to:"/dashboard"})},[c]);function l(o){o.preventDefault();const f=o.target.email.value,m=o.target.password.value;if(f.length>255)return a("Email too long!");if(m.length>80)return a("Password too long! Max character limit is 80");s({email:f,password:m},{onSuccess:()=>{n(f,m),u&&t("Loading...")},onError:w=>a(w.toString())})}return h.jsx("main",{className:"flex-1",children:h.jsx("div",{className:"relative bg-gradient-to-b from-cyan-600 to-[#202020] w-[320px] md:w-[500px] mx-auto h-[80vh]",children:h.jsxs("div",{className:"bg-[#202020] absolute top-0 left-[2px] w-[316px] md:w-[496px] h-[80vh]",children:[h.jsx("h1",{className:" relative z-2 pt-20 pb-10 text-center text-4xl md:text-6xl font-bold",children:"Sign Up"}),h.jsxs("form",{onSubmit:l,className:"relative z-2 flex flex-col mx-auto",children:[h.jsx("input",{type:"email",placeholder:"Email",className:"mx-auto border p-2 my-2 md:w-[300px]",id:"email",name:"email",required:!0}),h.jsx("input",{type:"password",placeholder:"Password",className:"mx-auto border p-2 my-2 md:w-[300px]",id:"password",name:"password",required:!0}),h.jsx("button",{className:"py-3 px-5 my-5 rounded font-bold tracking-widest bg-cyan-600 w-[200px] md:w-[300px] mx-auto cursor-pointer hover:bg-cyan-300 hover:text-[#202020] transition-all ease-in-out duration-300",children:"SIGNUP"}),h.jsxs("div",{className:"mx-auto",children:["Already have an account?"," ",h.jsx($,{to:"/login",className:"font-bold hover:text-cyan-300 transition-all ease-in-out duration-300",children:"Login"})]})]}),h.jsx("div",{className:"text-red-400 text-center",children:i}),h.jsx("div",{className:"text-center",children:r})]})})})}export{V as component};
